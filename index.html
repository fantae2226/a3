<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Assignment 3 MWD</title>
    
        <!--Bootstrap-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        
        <!--React-->
        <script src="https://unpkg.com/react@18/umd/react.development.js" ></script>
        <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" ></script>
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        
        <!--Style Sheet-->
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>

        <div id="root"></div>

        <script type="text/babel">

            const card_suits = ["Hearts", "Clubs", "Spades", "Diamonds"];
            const card_values = ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13"];


            const container = document.getElementById('root');
            const root = ReactDOM.createRoot(container);
            root.render(<MyApp />);
            




            function generateDeck(selected_card,set_selected_card) {
                let deck_array = [];
                for(let suit of card_suits){
                    for(let value of card_values){
                        let card_info = {
                            "suit" : suit,
                            "value": value,
                            "img" : getCardImg(suit, value, card_info, selected_card)
                        };
                        deck_array.push(card_info);
                    }
                }

                return deck_array;
                
            }

            function getCardImg(suit, rank, card, selected_card){
                let isSelected = false;
                if (card === selected_card){
                    isSelected = true
                }

                return (
                    <img src={`cards/${suit}_${rank}.png`} alt={`${rank} of ${suit}`}
                    className={isSelected ? "selected_card" : "card"} onClick={() => set_selected_card(card)}/>
                );
            }



            function MyApp() {

                // initial card and deck hooks
                const [deck, set_deck] = React.useState(generateDeck(selected_card,set_selected_card));
                const [hand, set_hand] = React.useState([]);
                const [selected_card, set_selected_card] = React.useState(false);


                const select_card = (card) => {
                    set_selected_card(selected_card === card ? null : card);  
                };

                const reset = () => {
                    set_deck(generateDeck());
                    set_hand([]);
                    set_selected_card(null);
                }

                const toss = () => {
                    if(selected_card !== null){
                        set_hand(hand.filter( (_,card) => card !== selected_card) );
                        set_selected_card(null);
                    }
                }

                const wildcard = () => {
                    let rand_suit = Math.floor(Math.random() * card_suits.length);
                    let rand_val = Math.floor(Math.random() * card_values.length);
                    const card = {
                        "suit": card_suits[rand_suit],
                        "value" : card_values[rand_val],
                        "img" : getCardImg(rand_suit, rand_val, card)
                    }
          
                    set_hand([...hand, card]);
                }

                const shuffle = () => {
                    const hand_copy = [...hand];


                    for(let i = 0; i < hand_copy.length; i++){
                        let x = Math.floor(Math.random() * hand_copy.length);
                        let y = Math.floor(Math.random() * hand_copy.length);

                        let temp = hand_copy[x];
                        hand_copy[x] = hand_copy[y];
                        hand_copy[y] = temp;
                    }

                    set_hand(hand_copy);
                    set_selected_card(null);
                }

                // const display_hand = () => {
                //     if(hand.length > 0){

                //     }
                // }

                const add_card = () => {
                    const newDeck = [...deck];
                    const newHand = [...hand];
                    
                    const random_index = Math.floor(Math.random() * newDeck.length);
                    
                    newHand.push(newDeck.splice(random_index, 1)[0]);
                    
                    set_deck(newDeck);
                    set_hand(newHand);
                    set_selected_card(null);
                }

                const display_deck = ()  => {
                    if (deck.length > 0) { // there are cards in deck 
                        return (<div className="card_back" onClick={() => add_card()}>
                                    <img src="cards\Card_Back_3.png" alt="card back"/>
                                </div>) 
                    }
                    else { // no cards in deck 
                        return <h3 className="no_cards">No Cards Remaining</h3>
                    }
                }









                return (
                    <div className="container-fluid text-center">
                        
                        <div id="title">
                            <div className="titleName">Ebby's Gambling Corner</div>
                        </div>

                        <div id="deck_container" className="d-flex align-items-center">
                            {display_deck()}
                        </div>
                        <div id="card-count">
                            {/* Display remaining cards in deck */}
                            <p>Cards Remaining: {deck.length}</p>
                        </div>

                        <div id="hand_container" className="d-flex align-items-center">
                            {hand.length > 0 ? (hand.map((card, index) => (
                                <div key={index}>
                                    {card.img}
                                </div>
                            ))
                            ) : (
                                <div>No cards in hand</div>
                            )}
                        </div>
                    </div>
                );

            }

        </script>


    </body>
</html>